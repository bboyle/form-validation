/*! Form validation - v1.0.1 - 2013-03-30
* https://github.com/bboyle/form-validation
* Copyright (c) 2013 Ben Boyle; Licensed MIT */
(function(e){"use strict";var t=1e4,i='<div class="status warn"><div class="inner"><h2>Please check your answers</h2><ol></ol></div></div>',n="input, select, textarea",r=function(){return!(this.disabled||this.validity.valid)},a="forcesForms",l=function(e,t){var i=this.data(a)||this.data(a,{}).data(a);return e!==void 0?t!==void 0?(i[e]=t,t):i[e]!==void 0?i[e]:null:i},s=function(t,i){return this.map(function(n,r){var a=e(r),l=null,s=null;return"object"==typeof i&&"group"===i.level?s=a.forcesForms("group").find(t)[0]:a.is(":radio, :checkbox")?s=a.closest("fieldset").find(t)[0]:(l=a.closest("form").find('label[for="'+r.id+'"]'),s=l.children(t)[0],s||".hint"===t&&(l.append('<small class="hint"></small>'),s=l.children(t)[0])),s})},o=function(){var t,i,a=e(this),l=a.forcesForms("alert");this.validity.valid?(a.forcesForms("question").find(".alert").filter(l).length>0?l.remove():(i=a.forcesForms("group").find(n).filter(r),i.length>0?l.text(i.forcesForms("getValidationMessage")):l.remove()),a.parentsUntil("form",".invalid").filter(function(){return 0===e(this).find(n).filter(r).length}).removeClass("invalid").find(".alert").remove()):(0===l.length&&(l=e('<em class="alert"/>')),l.text(a.forcesForms("getValidationMessage")),a.forcesForms("group").hasClass("atomic")&&(t={level:"group"}),a.forcesForms("label",t).parent().find(".label, .required").eq(-1).after(l))},u=function(){var t=e(this).closest("form"),r=t.find(n).filter(function a(){if(this.disabled)return!1;if(a.cache){if(a.cache[this.name]===!0)return!1}else a.cache={};return a.cache[this.name]=!0,this.validity&&!this.validity.valid}),s=l.call(t,"summaryElement")||l.call(t,"summaryElement",e(i)),o=s.find("ol"),u=!0;return r.length>0&&(o.find("li").remove(),r.each(function(){var t=e(this),i=t.forcesForms("group"),n=t.forcesForms("label",{level:i.length>0?"group":null}),r=n[0].id||n.generateId("label-"+this.id)[0].id,a=l.call(t,"summaryElement")||l.call(t,"summaryElement",e('<li><a href="#'+r+'"></a></li>'));0===i.length||i[0]!==u?(u=i[0],a.find("a").text(n.text().replace(/\?$/,"")+": "+t.forcesForms("getValidationMessage")).end().appendTo(o)):a.remove()})),r.length},c=function(t){var i=u.call(this),a=e(this);return a.find(".invalid").filter(function(){return 0===e(this).find(n).filter(r).length}).removeClass("invalid").find(".alert").remove(),i>0?(t.stopImmediatePropagation(),t.preventDefault(),function(t){var i=l.call(t,"summaryElement");t.prev(".status").not(i).remove(),t.before(i.fadeIn()),e(window).scrollTo(i)}(a),a.find(n).filter(r).each(function(){o.call(this)}).parentsUntil("form",".questions > li").not(".section, .compact").addClass("invalid"),!1):void 0},f=function(i){var n,r=i.timeStamp||e.now(),a=e(this),s=l.call(a,"summaryElement");return s&&s.remove(),n=l.call(a,"lastSubmitTimeStamp"),n&&t>r-n?(i.stopImmediatePropagation(),i.preventDefault(),!1):(l.call(a,"lastSubmitTimeStamp",r),void 0)},d={alert:function(){return this.map(function(t,i){var n,r=e(i);return r.is(":radio, :checkbox")===!0?r.closest("fieldset").find("legend > .alert")[0]:(n=r.forcesForms("group").filter(".atomic"),n.length>0?n.find("legend > .alert")[0]:e('label[for="'+i.id+'"] > .alert')[0])})},label:function(e){return s.call(this,".label",e)},hint:function(e){return s.call(this,".hint",e)},question:function(t){return"object"==typeof t&&"group"===t.level?this.forcesForms("group"):this.map(function(t,i){return e(i).parentsUntil("form",".questions > li")[0]})},group:function(){return this.map(function(t,i){return e(i).parentsUntil("form",".group").filter(function(){return e(this).children("fieldset").length>0})[0]})},validate:function(){return this.each(function(){e(this).closest("form").attr("novalidate",!0).unbind("submit",f).unbind("submit",c).bind("submit",c).bind("submit",f).find(n).unbind("change",o).bind("change",o)})},getValidationMessage:function(){var e=this[0].validity;return e===void 0||e.valid===!0?"":e.valueMissing?"Must be completed":e.customError?this[0].validationMessage:e.typeMismatch?"Must be an email address":e.patternMismatch?"Must use the format shown":"Must be a valid answer"}};e.fn.forcesForms=function(t){return d[t]?d[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?(e.error("Method "+t+" does not exist on jQuery.forcesForms"),void 0):d.init.apply(this,arguments)}})(jQuery);